<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>To Do</title>
    <script type="text/javascript" src="build/react.js"></script>
    <script type="text/javascript" src="build/JSXTransformer.js"></script>
    <script type="text/javascript" src="build/jquery-1.10.0.min.js"></script>
</head>
<body>
<div id="content"></div>
<script type="text/jsx">
    let data = [
        {category: "Sporting Goods", price: "$49.99", stocked: true, name: "Football"},
        {category: "Sporting Goods", price: "$9.99", stocked: true, name: "Baseball"},
        {category: "Sporting Goods", price: "$29.99", stocked: false, name: "Basketball"},
        {category: "Electronics", price: "$99.99", stocked: true, name: "iPod Touch"},
        {category: "Electronics", price: "$399.99", stocked: false, name: "iPhone 5"},
        {category: "Electronics", price: "$199.99", stocked: true, name: "Nexus 7"}
    ];

    let Search = React.createClass({
        render(){
            return (
                    <div>
                        <div>
                            <input type="text" ref="keywords" placeholder="search..."/>
                        </div>
                        <div>
                            <label>
                                <input type="checkbox" ref="instock"/>Only show products in stock
                            </label>
                        </div>
                        <hr/>
                    </div>
            );
        }
    });

    let ProductList = React.createClass({
        render(){
            let productListData = this.props.productList;
            let newProductListJason = [];
            productListData.map((item,index) => {
                if(!newProductListJason[item.category]){
                    newProductListJason[item.category] = [];
                }
                newProductListJason[item.category].push({
                    name:item.name,
                    price:item.price,
                    stocked:item.stocked
                });
            });

            let productList = [];
            newProductListJason.map((item,index) => {
                productList.push(
                        <tr>
                            <td colspan="2">{index}</td>
                        </tr>
                );
                item.map((detail,i) => {
                    productList.push(
                            <tr>
                                <td>{detail.name}</td>
                                <td>{detail.price}</td>
                            </tr>
                    );
                });
            });
            console.log(productList);
            return (
                    <div className="product-list">
                        <table>
                            <thead>
                                <tr>
                                    <th>Name</th>
                                    <th>Price</th>
                                </tr>
                            </thead>
                            <tbody>
                            {productList}
                            </tbody>
                        </table>
                    </div>
            );
        }
    });

    //mock frame
    let Mock = React.createClass({
        render(){
            return (
                    <div className="mock">
                        <Search />
                        <ProductList productList={this.props.data} />
                    </div>
            );
        }
    });

    React.render(
            <Mock data={data} />,
            document.getElementById('content')
    );
</script>
</body>
</html>